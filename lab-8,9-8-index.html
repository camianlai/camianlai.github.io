<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文学书苑 - 探索文字之美</title> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/lab-8(3).css">
</head>
<body>
    <div class="container">
        <div class="loading-overlay"><div class="loading-spinner"></div></div>
        <div class="preview-modal"><div class="modal-content"><button class="close-modal">&times;</button></div></div>
        <div class="message-toast"><i class="fas fa-check-circle"></i><span class="toast-text">操作成功！</span></div>
        <!-- 悬浮购物车 -->
     <div class="floating-cart">
     <i class="fas fa-shopping-cart hover-rotate"></i>  <!-- 这是购物车图标 -->
     <span>购物车</span>
     <span class="cart-badge">0</span>
     <div class="cart-dropdown">
        <!-- 购物车下拉内容 -->
     </div>
            <div class="cart-dropdown">
                <div class="cart-items" id="cartItems">
                    <div class="empty-cart">
                        <i class="fas fa-shopping-cart"></i>
                        <p>购物车是空的</p>
                    </div>
                </div>
                <div class="cart-total">
                    总计: ¥<span id="cartTotal">0.00</span>
                </div>
                <div class="cart-actions">
                    <button class="cart-action-btn clear-cart-btn" onclick="clearCart()">清空购物车</button>
                    <button class="cart-action-btn checkout-btn" onclick="checkout()">立即结算</button>
                </div>
            </div>
        </div>       
        <header>
            <div class="header-content">
                <h1>文学书苑</h1>
                <div class="header-subtitle">探索文字之美，品味文学之韵</div>
            </div>
            <!-- 新增：实时时间显示栏 -->
            <div class="time-display-bar">
            <div class="container">
            <span id="current-date">正在加载时间...</span>
            <span> | </span>
            <span id="current-time"></span>
            <span> | </span>
            <span id="current-week"></span>
            </div>
            </div>
        </header>
        <!-- 登录模态框 -->
        <div class="login-modal" id="loginModal">
            <div class="login-form">
                <button class="close-modal" id="closeModal">&times;</button>
                <h2>用户登录</h2><br>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">用户名：</label>
                        <input type="text" id="username" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="password">密码：</label>
                        <input type="password" id="password" name="password" required>
                    </div>
                    <div class="remember-me">
                        <input type="checkbox" id="remember" name="remember">
                        <label for="remember">记住我</label>
                    </div>
                    <button type="submit" class="login-btn">登录</button>
                </form>
                <div class="register-link">
                    <p>还没有账号？<a href="#" id="registerLink">立即注册</a></p>
                </div>
            </div>
        </div>
        <!-- 注册模态框 -->
        <div class="login-modal" id="registerModal">
            <div class="login-form">
                <button class="close-modal" id="closeRegisterModal">&times;</button>
                <h2>用户注册</h2><br>
                <form id="registerForm">
                    <div class="form-group">
                        <label for="reg-username">用户名：</label>
                        <input type="text" id="reg-username" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-email">邮箱：</label>
                        <input type="email" id="reg-email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-password">密码：</label>
                        <input type="password" id="reg-password" name="password" required>
                        <!-- 在id为“loginPassword”的input标签后，添加以下div -->
<div class="password-strength-container">
    <div class="strength-meter">
        <div class="strength-bar" id="strength-bar"></div>
    </div>
    <div class="strength-text" id="strength-text">请开始输入密码</div>
</div>
                    </div>
                    <div class="form-group">
                        <label for="reg-confirm-password">确认密码：</label>
                        <input type="password" id="reg-confirm-password" name="confirm-password" required>
                    </div>
                    <div class="remember-me">
                        <input type="checkbox" id="agree-terms" name="agree-terms" required>
                        <label for="agree-terms">我已阅读并同意服务条款</label>
                    </div>
                    <button type="submit" class="login-btn">注册</button>
                </form>
                <div class="register-link">
                    <p>已有账号？<a href="#" id="loginLink">立即登录</a></p>
                </div>
            </div>
        </div>
        <nav>
            <ul>
                <li><a href="#"><i class="fas fa-home"></i> 首页</a></li>
                <li><a href="#"><i class="fas fa-book-open"></i> 图书分类</a></li>
                <li><a href="#"><i class="fas fa-book"></i> 文学经典</a></li>
                <li><a href="#"><i class="fas fa-pen-fancy"></i> 现代文学</a></li>
                <li><a href="#"><i class="fas fa-globe-americas"></i> 世界文学</a></li>
                <li><a href="#search"><i class="fas fa-search"></i> 智能搜索</a></li>
                <li><a href="#"><i class="fas fa-user-edit"></i> 作家专栏</a></li>
                <li><a href="#"><i class="fas fa-envelope"></i> 联系我们</a></li>
            </ul>
            <!-- 新增登录注册链接 -->
            <div class="auth-links">
            <a href="#" class="login-link" id="navLoginBtn"><i class="fas fa-user"></i> 登录/注册</a>
            </div>
        </nav>
        <div class="container">
        <!-- 智能图书搜索框 -->
        <section id="search" class="search-section">
            <div class="search-container">
                <div class="search-header">
                    <h2><i class="fas fa-search"></i> 智能图书搜索</h2>
                    <div class="search-options">
                        <div class="filter-group">
                            <label><i class="fas fa-filter"></i> 筛选选项：</label>
                        </div>
                    </div>
                </div>
                
                <div class="search-box">
                    <input type="text" 
                           id="searchInput" 
                           class="search-input" 
                           placeholder="输入书名、作者或关键词进行搜索..."
                           autocomplete="off">
                    <div class="search-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    
                    <div id="searchResults" class="search-results">
                        <!-- 搜索结果将动态插入这里 -->
                    </div>
                </div>
                
                <div class="search-filters">
                    <div class="filter-group">
                        <label for="filterBy">筛选条件：</label>
                        <select id="filterBy">
                            <option value="all">全部</option>
                            <option value="title">按书名</option>
                            <option value="author">按作者</option>
                            <option value="category">按分类</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="categoryFilter">图书分类：</label>
                        <select id="categoryFilter">
                            <option value="all">全部分类</option>
                            <option value="文学">文学</option>
                            <option value="小说">小说</option>
                            <option value="历史">历史</option>
                            <option value="科技">科技</option>
                            <option value="经济">经济</option>
                            <option value="哲学">哲学</option>
                        </select>
                    </div>
                </div>
            </div>
            <!-- 新增：限时抢购倒计时板块 -->
<section class="flash-sale-section">
    <div class="container">
        <h2><i class="fas fa-bolt"></i> 限时抢购</h2>
        <p class="sale-description">精选古典名著限时特惠，机会难得，莫失良机！</p>
        <div class="countdown-box">
            <h3>活动结束剩余：</h3>
            <div class="countdown-timer" id="countdown-timer">
                <div class="time-unit">
                    <span class="number" id="days">00</span>
                    <span class="label">天</span>
                </div>
                <div class="time-unit">
                    <span class="number" id="hours">00</span>
                    <span class="label">时</span>
                </div>
                <div class="time-unit">
                    <span class="number" id="minutes">00</span>
                    <span class="label">分</span>
                </div>
                <div class="time-unit">
                    <span class="number" id="seconds">00</span>
                    <span class="label">秒</span>
                </div>
            </div>
            <p class="deadline">活动截止：2025年12月31日 23:59:59</p>
        </div>
    </div>
</section>
        </section>
        <div class="main-content">
            <div class="filter-section">
                <div class="filter-group">
                    <div class="filter-dropdown">
                        <button class="filter-btn"><i class="fas fa-book"></i> 文学分类</button>
                        <div class="filter-menu">
                            <label><input type="checkbox" name="category" value="classic"> 古典文学</label><br>
                            <label><input type="checkbox" name="category" value="modern"> 现代文学</label><br>
                            <label><input type="checkbox" name="category" value="romance"> 浪漫主义</label>
                        </div>
                    </div>
                    <div class="filter-dropdown">
                        <button class="filter-btn"><i class="fas fa-tag"></i> 价格区间</button>
                        <div class="filter-menu">
                            <label><input type="radio" name="price" value="0-50"> 0-50元</label><br>
                            <label><input type="radio" name="price" value="50-100"> 50-100元</label><br>
                            <label><input type="radio" name="price" value="100+"> 100元以上</label>
                        </div>
                    </div>
                    <div class="filter-dropdown">
                        <button class="filter-btn"><i class="fas fa-star"></i> 读者评分</button>
                        <div class="filter-menu">
                            <label><input type="radio" name="rating" value="4+"> 4星以上</label><br>
                            <label><input type="radio" name="rating" value="3+"> 3星以上</label><br>
                            <label><input type="radio" name="rating" value="all"> 全部评分</label>
                        </div>
                    </div>
                </div>
                <div class="active-filters" id="activeFilters">
                    <!-- 动态添加的活动筛选条件 -->
                </div>
            </div>
        </section>
            <div class="highlight-box"><i class="fas fa-gift"></i> 本周推荐：经典文学作品限时特惠，满100减20！</div>            
            <aside class="left-sidebar">
                <h2><i class="fas fa-list"></i> 文学分类</h2>
               <ul class="sidebar-list">
            <li><a href="#"><i class="fas fa-scroll"></i>  古典文学</a></li>
            <li><a href="#"><i class="fas fa-heart"></i>  浪漫主义</a></li>
            <li><a href="#"><i class="fas fa-city"></i>  现代主义</a></li>
            <li><a href="#"><i class="fas fa-hat-wizard"></i>  魔幻现实主义</a></li>
            <li><a href="#"><i class="fas fa-mask"></i>  戏剧文学</a></li>
            <li><a href="#"><i class="fas fa-pen-fancy"></i>  散文随笔</a></li>
             </ul><br>
                <div class="decorative-line"></div>
                <h2><i class="fas fa-fire"></i> 热门标签</h2>
                <div style="display:flex;flex-wrap:wrap;gap:0.5rem;margin-top:1rem">
                    <span style="background:#e8e2d1;padding:0.3rem 0.7rem;border-radius:20px;font-size:0.8rem">经典名著</span>
                    <span style="background:#e8e2d1;padding:0.3rem 0.7rem;border-radius:20px;font-size:0.8rem">畅销小说</span>
                    <span style="background:#e8e2d1;padding:0.3rem 0.7rem;border-radius:20px;font-size:0.8rem">文学奖作品</span>
                    <span style="background:#e8e2d1;padding:0.3rem 0.7rem;border-radius:20px;font-size:0.8rem">作家签名版</span>
                </div><br><br><br><br><br><br><br><br><br><br><br>
            </aside>
            <main class="content">
                <section>
                    <h3 class="category-title">古典文学</h3>
                    <div class="books-container">
                        <!-- 3D翻转图书卡片1 -->
                        <div class="book-card">
                            <div class="card-inner">
                                <div class="card-front">
                                    <div class="book-image">
                                        <img src="../image/红楼梦.jpg">
                                    </div>
                                </div>
                                <div class="card-back">
                                    <div class="book-info">
                                        <h3>红楼梦</h3>
                                        <div class="book-rating">
                                            <div class="stars">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star-half-alt"></i>
                                            </div>
                                            <div class="rating-value">4.5分 (1280评价)</div>
                                        </div>
                                        <p class="book-description">
                                            《红楼梦》，中国古代章回体长篇小说，中国古典四大名著之一，一般认为是清代作家曹雪芹所著。
                                        </p>
                                        <div class="book-meta">
                                            <div class="meta-item">
                                                <div class="meta-value">1200</div>
                                                <div class="meta-label">页数</div>
                                            </div>
                                            <div class="meta-item">
                                                <div class="meta-value">1791年</div>
                                                <div class="meta-label">出版时间</div>
                                            </div>
                                            <div class="meta-item">
                                                <div class="meta-value">古典文学</div>
                                                <div class="meta-label">分类</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="book-card">
                            <div class="card-inner">
                                <div class="card-front">
                                    <div class="book-image" style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);">
                                        <img src="../image/诗经.jpg">
                                    </div>
                                </div>
                                <div class="card-back">
                                    <div class="book-info">
                                        <h3>诗经</h3>
                                        <div class="book-rating">
                                            <div class="stars">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="far fa-star"></i>
                                            </div>
                                            <div class="rating-value">4.0分 (956评价)</div>
                                        </div>
                                        <p class="book-description">
                                            《诗经》，是中国古代诗歌的开端，最早的一部诗歌总集，收集了西周初年至春秋中叶的诗歌。
                                        </p>
                                        <div class="book-meta">
                                            <div class="meta-item">
                                                <div class="meta-value">480</div>
                                                <div class="meta-label">页数</div>
                                            </div>
                                            <div class="meta-item">
                                                <div class="meta-value">公元前6世纪</div>
                                                <div class="meta-label">成书时间</div>
                                            </div>
                                            <div class="meta-item">
                                                <div class="meta-value">古典文学</div>
                                                <div class="meta-label">分类</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <h3 class="category-title">现代文学</h3>
                    <div class="books-container">
                        <div class="book-card">
                            <div class="card-inner">
                                <div class="card-front">
                                    <div class="book-image">
                                        <img src="../image/围城.jpg">
                                    </div>
                                </div>
                                <div class="card-back">
                                    <div class="book-info">
                                        <h3>围城</h3>
                                        <div class="book-rating">
                                            <div class="stars">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star-half-alt"></i>
                                            </div>
                                            <div class="rating-value">4.5分 (1280评价)</div>
                                        </div>
                                        <p class="book-description">
                                            《围城》，中国现代文学史上一部风格独特的讽刺小说，被誉为"新儒林外史"。
                                        </p>
                                        <div class="book-meta">
                                            <div class="meta-item">
                                                <div class="meta-value">392</div>
                                                <div class="meta-label">页数</div>
                                            </div>
                                            <div class="meta-item">
                                                <div class="meta-value">1947年</div>
                                                <div class="meta-label">出版时间</div>
                                            </div>
                                            <div class="meta-item">
                                                <div class="meta-value">现代文学</div>
                                                <div class="meta-label">分类</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="book-card">
                            <div class="card-inner">
                                <div class="card-front">
                                    <div class="book-image" style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);">
                                        <img src="../image/边城.jpg">
                                    </div>
                                </div>
                                <div class="card-back">
                                    <div class="book-info">
                                        <h3>边城</h3>
                                        <div class="book-rating">
                                            <div class="stars">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="far fa-star"></i>
                                            </div>
                                            <div class="rating-value">4.0分 (956评价)</div>
                                        </div>
                                        <p class="book-description">
                                            《边城》，以20世纪30年代川湘交界的边城小镇茶峒峒为背景，描绘了湘西地区特有的风土人情。
                                        </p>
                                        <div class="book-meta">
                                            <div class="meta-item">
                                                <div class="meta-value">256</div>
                                                <div class="meta-label">页数</div>
                                            </div>
                                            <div class="meta-item">
                                                <div class="meta-value">1934年</div>
                                                <div class="meta-label">成书时间</div>
                                            </div>
                                            <div class="meta-item">
                                                <div class="meta-value">现代文学</div>
                                                <div class="meta-label">分类</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>             
            </main>          
            <aside class="right-sidebar">
                <div class="decorative-line"></div>
                <h2><i class="fas fa-user-tie"></i> 文学大师</h2>
                <ul class="sidebar-list">
                    <li><a href="#">鲁迅</a></li>
                    <li><a href="#">老舍</a></li>
                    <li><a href="#">巴金</a></li>
                    <li><a href="#">茅盾</a></li>
                    <li><a href="#">沈从文</a></li>
                </ul>
                <div class="decorative-line"></div>
                <div style="background:linear-gradient(135deg,var(--accent-color),var(--accent-dark));color:var(--text-light);padding:1.2rem;margin:1.5rem 0;border-radius:var(--radius)">
                    <h3><i class="fas fa-crown"></i> 会员专享</h3>
                    <p style="margin-top:0.5rem;font-size:0.9rem">借阅图书免运费，参与线下活动优先报名！</p>
                </div>
                <div class="decorative-line"></div>
                <h2><i class="fas fa-newspaper"></i> 文学资讯</h2>
                <div style="margin-top:1rem">
                    <div style="padding:0.8rem 0;border-bottom:1px dashed var(--light-border)">
                        <div style="font-weight:600;font-size:0.9rem">2023年诺贝尔文学奖揭晓</div>
                        <div style="font-size:0.8rem;color:#666;margin-top:0.3rem">2天前</div>
                    </div>
                    <div style="padding:0.8rem 0;border-bottom:1px dashed var(--light-border)">
                        <div style="font-weight:600;font-size:0.9rem">全国文学创作大赛征稿启事</div>
                        <div style="font-size:0.8rem;color:#666;margin-top:0.3rem">5天前</div>
                    </div>
                    <div style="padding:0.8rem 0">
                        <div style="font-weight:600;font-size:0.9rem">著名作家新书分享会即将举行</div>
                        <div style="font-size:0.8rem;color:#666;margin-top:0.3rem">1周前</div>
                    </div>
                </div>
            </aside>
        </div>
        <div class="container">
        <!-- 3D环形图书展示 -->
        <section class="carousel-section">
            <h2 class="section-title">精选图书展示</h2>
            <div class="carousel-container">
                <div class="carousel-track" id="carouselTrack">
                    <!-- 环形展示项 -->
                    <div class="carousel-item">
                        <div class="carousel-content">
                            <img src="../image/三体.jpg">
                            <h4>三体</h4>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="carousel-content">
                            <img src="../image/月亮与六便士.jpg">
                            <h4>月亮与六便士</h4>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="carousel-content">
                            <img src="../image/老人与海.jpg">
                            <h4>老人与海</h4>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="carousel-content">
                            <img src="../image/龙族.jpg">
                            <h4>龙族</h4>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="carousel-content">
                            <img src="../image/狼图腾.jpg">
                            <h4>狼图腾</h4>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="carousel-content">
                            <img src="../image/围城.jpg">
                            <h4>围城</h4>
                        </div>
                    </div>
                </div>
                
                <div class="carousel-nav">
                    <button class="carousel-btn prev"><i class="fas fa-chevron-left"></i></button>
                    <button class="carousel-btn next"><i class="fas fa-chevron-right"></i></button>
                </div>
                
                <div class="carousel-controls">
                    <button class="control-btn" id="speedUp">加速</button>
                    <button class="control-btn" id="slowDown">减速</button>
                    <button class="control-btn" id="toggleRotation">暂停/继续</button>
                </div>               
                <div class="carousel-indicators" id="carouselIndicators">
                    <!-- 指示器将通过JS动态生成 -->
                </div>
            </div>
        </section>  
        <footer>
            <p>文学书苑</p>
            <div class="social-icons">
                <a href="#" class="social-icon"><i class="fab fa-weixin"></i></a>
                <a href="#" class="social-icon"><i class="fab fa-weibo"></i></a>
                <a href="#" class="social-icon"><i class="fab fa-qq"></i></a>
                <a href="#" class="social-icon"><i class="fas fa-envelope"></i></a>
            </div>
            <p style="margin-top:1rem;font-size:0.9rem;opacity:0.8">© 文学书苑 版权所有</p>
        </footer>
    </div>
    
    <script>
         // 功能1：实时时间显示
function updateCurrentTime() {
    const now = new Date();

    // 格式化年月日
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const date = String(now.getDate()).padStart(2, '0');
    document.getElementById('current-date').textContent = `${year}年${month}月${date}日`;

    // 格式化星期
    const weekDays = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
    document.getElementById('current-week').textContent = weekDays[now.getDay()];

    // 格式化时分秒
    const hour = String(now.getHours()).padStart(2, '0');
    const minute = String(now.getMinutes()).padStart(2, '0');
    const second = String(now.getSeconds()).padStart(2, '0');
    document.getElementById('current-time').textContent = `${hour}:${minute}:${second}`;
}

// 页面加载后立即执行一次，然后每秒更新
updateCurrentTime();
setInterval(updateCurrentTime, 1000);
// 功能2：限时抢购倒计时
function updateFlashSaleCountdown() {
    // 设置活动截止时间 (例如：2025-12-31 23:59:59)
    const deadline = new Date('December 31, 2025 23:59:59').getTime();
    const now = new Date().getTime();
    const timeLeft = deadline - now;

    // 如果时间已到，停止计时
    if (timeLeft < 0) {
        document.getElementById('countdown-timer').innerHTML = '<h3>活动已结束！</h3>';
        return;
    }

    // 计算天、时、分、秒
    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);

    // 更新显示
    document.getElementById('days').textContent = String(days).padStart(2, '0');
    document.getElementById('hours').textContent = String(hours).padStart(2, '0');
    document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
    document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
}

// 初始化并每秒更新倒计时
updateFlashSaleCountdown();
const countdownInterval = setInterval(updateFlashSaleCountdown, 1000);
// 修复登录模态框功能
function initLoginModal() {
    const navLoginBtn = document.getElementById('navLoginBtn'); // 修改为新的ID
    const loginModal = document.getElementById('loginModal');
    const registerModal = document.getElementById('registerModal');
    const closeModal = document.getElementById('closeModal');
    const closeRegisterModal = document.getElementById('closeRegisterModal');
    const registerLink = document.getElementById('registerLink');
    const loginLink = document.getElementById('loginLink');
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');

    // 打开登录模态框
    navLoginBtn.addEventListener('click', function(e) {
        e.preventDefault();
        loginModal.style.display = 'flex';
        registerModal.style.display = 'none';
    });

    // 关闭登录模态框
    closeModal.addEventListener('click', function() {
        loginModal.style.display = 'none';
    });

    // 关闭注册模态框
    closeRegisterModal.addEventListener('click', function() {
        registerModal.style.display = 'none';
    });

    // 点击模态框外部关闭
    loginModal.addEventListener('click', function(e) {
        if (e.target === loginModal) {
            loginModal.style.display = 'none';
        }
    });

    registerModal.addEventListener('click', function(e) {
        if (e.target === registerModal) {
            registerModal.style.display = 'none';
        }
    });

    // 注册链接点击事件 - 切换到注册模态框
    registerLink.addEventListener('click', function(e) {
        e.preventDefault();
        loginModal.style.display = 'none';
        registerModal.style.display = 'flex';
    });

    // 登录链接点击事件 - 切换到登录模态框
    loginLink.addEventListener('click', function(e) {
        e.preventDefault();
        registerModal.style.display = 'none';
        loginModal.style.display = 'flex';
    });

    // 登录表单提交
    loginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const username = document.getElementById('username').value;
        showMessage(`欢迎回来，${username}！`);
        loginModal.style.display = 'none';
    });

    // 注册表单提交
    registerForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const username = document.getElementById('reg-username').value;
        const password = document.getElementById('reg-password').value;
        const confirmPassword = document.getElementById('reg-confirm-password').value;
        
        if (password !== confirmPassword) {
            alert('两次输入的密码不一致！');
            return;
        }
        
        showMessage(`注册成功，欢迎 ${username}！`);
        registerModal.style.display = 'none';
    });

    // 密码强度实时验证
    function checkPasswordStrength(password) {
        const bar = document.getElementById('strength-bar');
        const text = document.getElementById('strength-text');

        // 重置
        bar.className = 'strength-bar';
        text.textContent = '请开始输入密码';

        if (!password) {
            return;
        }

        let strength = 0;
        // 长度检查
        if (password.length >= 8) strength += 1;
        // 包含小写字母
        if (/[a-z]/.test(password)) strength += 1;
        // 包含大写字母
        if (/[A-Z]/.test(password)) strength += 1;
        // 包含数字
        if (/[0-9]/.test(password)) strength += 1;
        // 包含特殊字符
        if (/[^A-Za-z0-9]/.test(password)) strength += 1;

        // 根据得分判断强度
        if (password.length < 6) {
            bar.classList.add('strength-weak');
            text.textContent = '密码强度：弱 (建议至少6位)';
            text.style.color = '#e53935';
        } else if (strength < 4) {
            bar.classList.add('strength-medium');
            text.textContent = '密码强度：中';
            text.style.color = '#ffb300';
        } else {
            bar.classList.add('strength-strong');
            text.textContent = '密码强度：强';
            text.style.color = '#4caf50';
        }
    }

    // 在注册表单的密码输入框上绑定输入事件
    document.getElementById('reg-password').addEventListener('input', function() {
        checkPasswordStrength(this.value);
    });
}

// 在DOM加载完成后初始化
document.addEventListener('DOMContentLoaded', function() {
    showLoading();
    setTimeout(() => {
        hideLoading();
        showMessage('页面加载完成！');
        
        // 初始化所有功能
        initLoginModal(); // 添加这行代码！
        initBookInteractions();
        initFilterFunctionality();
        initPreviewModal();
        initCart();
        initDetailPopupActions();
        initImageZoom();
    }, 1500);
});

        // 购物车数据
        let cart = [];
        let cartCount = 0;
        let cartTotal = 0;
        
        // 筛选条件
        let activeFilters = {
            category: [],
            price: null,
            rating: null
        };
        
        document.addEventListener('DOMContentLoaded', function() {
            showLoading();
            setTimeout(() => {
                hideLoading();
                showMessage('页面加载完成！');
            }, 1500);
            
        });
        
        function showLoading() {
            document.querySelector('.loading-overlay').classList.add('show');
        }
        
        function hideLoading() {
            document.querySelector('.loading-overlay').classList.remove('show');
        }
        
        function showMessage(text) {
            const toast = document.querySelector('.message-toast');
            toast.querySelector('.toast-text').textContent = text;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // 其他原有函数保持不变...
        // [此处保留所有原有的JavaScript函数，包括initFilterFunctionality, updateActiveFilters, filterBooks等]
        
        // 初始化筛选功能
        function initFilterFunctionality() {
            // 分类筛选
            document.querySelectorAll('input[name="category"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    if (this.checked) {
                        activeFilters.category.push(this.value);
                    } else {
                        activeFilters.category = activeFilters.category.filter(cat => cat !== this.value);
                    }
                    updateActiveFilters();
                    filterBooks();
                });
            });
            
            // 价格筛选
            document.querySelectorAll('input[name="price"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.checked) {
                        activeFilters.price = this.value;
                    } else if (activeFilters.price === this.value) {
                        activeFilters.price = null;
                    }
                    updateActiveFilters();
                    filterBooks();
                });
            });
            
            // 评分筛选
            document.querySelectorAll('input[name="rating"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.checked) {
                        activeFilters.rating = this.value;
                    } else if (activeFilters.rating === this.value) {
                        activeFilters.rating = null;
                    }
                    updateActiveFilters();
                    filterBooks();
                });
            });
        }
        
        // 更新活动筛选条件显示
        function updateActiveFilters() {
            const activeFiltersContainer = document.getElementById('activeFilters');
            activeFiltersContainer.innerHTML = '';
            
            // 分类筛选
            activeFilters.category.forEach(cat => {
                const filterElement = document.createElement('div');
                filterElement.className = 'active-filter';
                filterElement.innerHTML = `分类: ${getCategoryName(cat)} <span class="remove-filter" data-type="category" data-value="${cat}">×</span>`;
                activeFiltersContainer.appendChild(filterElement);
            });
            
            // 价格筛选
            if (activeFilters.price) {
                const filterElement = document.createElement('div');
                filterElement.className = 'active-filter';
                filterElement.innerHTML = `价格: ${getPriceRangeName(activeFilters.price)} <span class="remove-filter" data-type="price" data-value="${activeFilters.price}">×</span>`;
                activeFiltersContainer.appendChild(filterElement);
            }
            
            // 评分筛选
            if (activeFilters.rating) {
                const filterElement = document.createElement('div');
                filterElement.className = 'active-filter';
                filterElement.innerHTML = `评分: ${getRatingName(activeFilters.rating)} <span class="remove-filter" data-type="rating" data-value="${activeFilters.rating}">×</span>`;
                activeFiltersContainer.appendChild(filterElement);
            }
            
            // 添加移除筛选条件的事件
            document.querySelectorAll('.remove-filter').forEach(button => {
                button.addEventListener('click', function() {
                    const type = this.dataset.type;
                    const value = this.dataset.value;
                    
                    if (type === 'category') {
                        activeFilters.category = activeFilters.category.filter(cat => cat !== value);
                        document.querySelector(`input[name="category"][value="${value}"]`).checked = false;
                    } else if (type === 'price') {
                        activeFilters.price = null;
                        document.querySelector(`input[name="price"][value="${value}"]`).checked = false;
                    } else if (type === 'rating') {
                        activeFilters.rating = null;
                        document.querySelector(`input[name="rating"][value="${value}"]`).checked = false;
                    }
                    
                    updateActiveFilters();
                    filterBooks();
                });
            });
        }
        
        // 获取分类名称
        function getCategoryName(value) {
            const names = {
                'classic': '古典文学',
                'modern': '现代文学',
                'romance': '浪漫主义'
            };
            return names[value] || value;
        }
        
        // 获取价格范围名称
        function getPriceRangeName(value) {
            const names = {
                '0-50': '0-50元',
                '50-100': '50-100元',
                '100+': '100元以上'
            };
            return names[value] || value;
        }
        
        // 获取评分名称
        function getRatingName(value) {
            const names = {
                '4+': '4星以上',
                '3+': '3星以上',
                'all': '全部评分'
            };
            return names[value] || value;
        }
        
        // 筛选书籍
        function filterBooks() {
            const bookItems = document.querySelectorAll('.book-item');
            
            bookItems.forEach(item => {
                let show = true;
                
                // 分类筛选
                if (activeFilters.category.length > 0) {
                    const category = item.dataset.category;
                    if (!activeFilters.category.includes(category)) {
                        show = false;
                    }
                }
                
                // 价格筛选
                if (activeFilters.price) {
                    const price = parseFloat(item.dataset.price);
                    if (activeFilters.price === '0-50' && (price < 0 || price > 50)) {
                        show = false;
                    } else if (activeFilters.price === '50-100' && (price < 50 || price > 100)) {
                        show = false;
                    } else if (activeFilters.price === '100+' && price < 100) {
                        show = false;
                    }
                }
                
                // 评分筛选
                if (activeFilters.rating) {
                    const rating = parseFloat(item.dataset.rating);
                    if (activeFilters.rating === '4+' && rating < 4) {
                        show = false;
                    } else if (activeFilters.rating === '3+' && rating < 3) {
                        show = false;
                    }
                }
                
                // 显示或隐藏书籍
                if (show) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }
        function initImageZoom() {
    const containers = document.querySelectorAll('.image-zoom-container');
    
    containers.forEach(container => {
        const img = container.querySelector('img');
        const lens = container.querySelector('.zoom-lens');
        const result = container.querySelector('.zoom-result');
        
        if (!img || !lens || !result) return;
        
        // 计算放大比例
        const cx = result.offsetWidth / lens.offsetWidth;
        const cy = result.offsetHeight / lens.offsetHeight;
        
        // 设置放大背景
        result.style.backgroundImage = `url('${img.src}')`;
        result.style.backgroundSize = `${img.width * cx}px ${img.height * cy}px`;
        
        container.addEventListener('mousemove', function(e) {
            const pos = getCursorPos(e, img);
            let x = pos.x - lens.offsetWidth / 2;
            let y = pos.y - lens.offsetHeight / 2;
            
            // 边界检查
            x = Math.max(0, Math.min(x, img.width - lens.offsetWidth));
            y = Math.max(0, Math.min(y, img.height - lens.offsetHeight));
            
            lens.style.left = x + 'px';
            lens.style.top = y + 'px';
            result.style.backgroundPosition = `-${x * cx}px -${y * cy}px`;
        });
        
        container.addEventListener('mouseenter', function() {
            lens.style.display = 'block';
            result.style.display = 'block';
        });
        
        container.addEventListener('mouseleave', function() {
            lens.style.display = 'none';
            result.style.display = 'none';
        });
    });
}     function getCursorPos(e, img) {
    const rect = img.getBoundingClientRect();
    return {
        x: e.clientX - rect.left,
        y: e.clientY - rect.top
    };
}  
        function initCart() {
            // 为所有"加入购物车"按钮添加事件
            document.querySelectorAll('.add-cart-btn').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    addToCart(this);
                });
            });
            // 加载本地存储的购物车数据
            loadCartFromStorage();
        }
        function addToCart(button) {
            const bookItem = button.closest('.book-item');
            const bookId = bookItem.dataset.bookId;
            const bookTitle = bookItem.querySelector('.book-title').textContent;
            const bookPrice = parseFloat(bookItem.querySelector('.price').textContent.replace('¥', ''));
            const bookImage = bookItem.querySelector('.book-image img').src;
            
            // 检查是否已在购物车
            const existingItem = cart.find(item => item.id === bookId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: bookId,
                    title: bookTitle,
                    price: bookPrice,
                    image: bookImage,
                    quantity: 1
                });
            }
            
            // 更新购物车
            updateCart();
            showMessage(`《${bookTitle}》已加入购物车`);
            
            // 添加点击动画
            button.style.transform = 'scale(0.9)';
            setTimeout(() => {
                button.style.transform = 'scale(1)';
            }, 200);
        }
        
        function removeFromCart(bookId) {
            cart = cart.filter(item => item.id !== bookId);
            updateCart();
            showMessage('商品已从购物车移除');
        }
        
        function updateQuantity(bookId, change) {
            const item = cart.find(item => item.id === bookId);
            if (item) {
                item.quantity += change;
                if (item.quantity < 1) item.quantity = 1;
                updateCart();
            }
        }
        
        function updateCart() {
            // 计算总数量和总价
            cartCount = cart.reduce((total, item) => total + item.quantity, 0);
            cartTotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            
            // 更新购物车徽章
            document.querySelectorAll('.cart-badge').forEach(badge => {
                badge.textContent = cartCount;
                if (cartCount > 0) {
                    badge.style.animation = 'none';
                    void badge.offsetWidth; // 触发重绘
                    badge.style.animation = 'bounce 0.5s';
                }
            });
            
            // 更新购物车下拉内容
            const cartItems = document.getElementById('cartItems');
            
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="empty-cart">
                        <i class="fas fa-shopping-cart"></i>
                        <p>购物车是空的</p>
                    </div>
                `;
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div class="cart-item">
                        <div class="cart-item-image"><img src="${item.image}" alt="${item.title}" style="width:100%;height:100%;object-fit:cover;"> </div>
                        <div class="cart-item-info">
                            <div class="cart-item-title">${item.title}</div>
                            <div class="cart-item-price">¥${item.price.toFixed(2)}</div>
                            <div class="cart-item-quantity">
                                <button class="quantity-btn" onclick="updateQuantity('${item.id}', -1)">-</button>
                                <input type="text" class="quantity-input" value="${item.quantity}" readonly>
                                <button class="quantity-btn" onclick="updateQuantity('${item.id}', 1)">+</button>
                            </div>
                        </div>
                        <button class="remove-item" onclick="removeFromCart('${item.id}')">&times;</button>
                    </div>
                `).join('');
            }
            
            // 更新总价
            document.getElementById('cartTotal').textContent = cartTotal.toFixed(2);
            
            // 保存到本地存储
            saveCartToStorage();
        }
        
        function clearCart() {
            if (cart.length === 0) return;
            
            if (confirm('确定要清空购物车吗？')) {
                cart = [];
                updateCart();
                showMessage('购物车已清空');
            }
        }
        
        function checkout() {
            if (cart.length === 0) {
                showMessage('购物车是空的，请先添加商品');
                return;
            }
            
            showMessage(`开始结算，总计：¥${cartTotal.toFixed(2)}`);
            // 这里可以添加实际的结算逻辑
        }
        
        function saveCartToStorage() {
            localStorage.setItem('bookstore_cart', JSON.stringify(cart));
        }
        
        function loadCartFromStorage() {
            const savedCart = localStorage.getItem('bookstore_cart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
                updateCart();
            }
        }
        
        function initBookInteractions() {
            const actionButtons = document.querySelectorAll('.action-btn');
            
            actionButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const bookItem = this.closest('.book-item');
                    const bookTitle = bookItem.querySelector('.book-title').textContent;
                    
                    if (this.classList.contains('buy-now-btn')) {
                        showMessage(`开始购买《${bookTitle}》`);
                    } else if (this.classList.contains('view-detail-btn')) {
                        showMessage(`查看《${bookTitle}》详情`);
                    }
                });
            });
            
            const bookImages = document.querySelectorAll('.book-image');
            bookImages.forEach(image => {
                image.addEventListener('click', function() {
                    const bookTitle = this.closest('.book-item').querySelector('.book-title').textContent;
                    const modal = document.querySelector('.preview-modal');
                    const modalContent = modal.querySelector('.modal-content');
                    
                    while(modalContent.children.length > 1) {
                        modalContent.removeChild(modalContent.lastChild);
                    }
                    
                    const previewContent = document.createElement('div');
                    previewContent.style.padding = '2rem';
                    previewContent.innerHTML = `<h2>${bookTitle}</h2><p style="margin-top:1rem;color:#666">本书预览内容即将呈现...</p><div style="margin-top:2rem;display:flex;gap:1rem"><button style="padding:0.8rem 1.5rem;background:var(--primary-color);color:white;border:none;border-radius:4px;cursor:pointer">加入购物车</button><button style="padding:0.8rem 1.5rem;background:var(--accent-color);color:white;border:none;border-radius:4px;cursor:pointer">立即购买</button></div>`;
                    modalContent.appendChild(previewContent);
                    modal.classList.add('show');
                    document.body.style.overflow = 'hidden';
                });
            });
            
            // 关闭模态框
            document.querySelector('.close-modal').addEventListener('click', function() {
                document.querySelector('.preview-modal').classList.remove('show');
                document.body.style.overflow = 'auto';
            });
        }
        
        function initPreviewModal() {
            // 点击模态框外部关闭
            document.querySelector('.preview-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('show');
                    document.body.style.overflow = 'auto';
                }
            });
        }
         document.addEventListener('DOMContentLoaded', function() {
            // 初始化3D环形展示
                        init3DCarousel();
        });
        function init3DCarousel() {
            const track = document.getElementById('carouselTrack');
            const items = document.querySelectorAll('.carousel-item');
            const prevBtn = document.querySelector('.carousel-btn.prev');
            const nextBtn = document.querySelector('.carousel-btn.next');
            const speedUpBtn = document.getElementById('speedUp');
            const slowDownBtn = document.getElementById('slowDown');
            const toggleBtn = document.getElementById('toggleRotation');
            const indicatorsContainer = document.getElementById('carouselIndicators');
            
            const itemCount = items.length;
            const radius = 350; // 增加环形半径，避免图片交叉
            let currentAngle = 0;
            let autoRotate = true;
            let rotationSpeed = 0.008; // 降低默认旋转速度
            let rotationInterval;
            
            // 创建指示器
            items.forEach((_, index) => {
                const indicator = document.createElement('div');
                indicator.className = 'carousel-indicator';
                if (index === 0) indicator.classList.add('active');
                indicator.addEventListener('click', () => rotateTo(index));
                indicatorsContainer.appendChild(indicator);
            });
            
            const indicators = document.querySelectorAll('.carousel-indicator');
            
            // 初始化3D布局
            function layoutItems() {
                const angleStep = (2 * Math.PI) / itemCount;
                
                items.forEach((item, index) => {
                    const angle = index * angleStep + currentAngle;
                    const x = Math.sin(angle) * radius;
                    const z = Math.cos(angle) * radius;
                    
                    // 设置3D变换，增加间距避免交叉
                    item.style.transform = `translateX(${x}px) translateZ(${z}px) rotateY(${-angle}rad)`;
                    
                    // 根据Z轴位置调整层级、透明度和缩放
                    const scale = 0.8 + (z + radius) / (radius * 2) * 0.4; // 调整缩放范围
                    const opacity = 0.6 + (z + radius) / (radius * 2) * 0.4; // 调整透明度范围
                    
                    item.style.zIndex = Math.round(z + radius);
                    item.style.opacity = opacity;
                    
                    // 确保图片完全适应容器
                    const img = item.querySelector('img');
                    if (img) {
                        img.style.transform = `scale(${scale})`;
                        img.style.objectFit = 'cover';
                        img.style.width = '100%';
                        img.style.height = '100%';
                    }
                });
            }
            
            // 旋转到特定索引
            function rotateTo(index) {
                const targetAngle = -index * (2 * Math.PI) / itemCount;
                currentAngle = targetAngle;
                layoutItems();
                updateIndicators(index);
            }
            
            // 旋转指定角度
            function rotate(angle) {
                currentAngle += angle;
                layoutItems();
                
                // 计算当前激活的索引
                const activeIndex = Math.round((currentAngle % (2 * Math.PI)) / (2 * Math.PI) * itemCount) % itemCount;
                const normalizedIndex = activeIndex < 0 ? itemCount + activeIndex : activeIndex;
                updateIndicators(normalizedIndex);
            }
            
            // 更新指示器状态
            function updateIndicators(activeIndex) {
                indicators.forEach((indicator, index) => {
                    indicator.classList.toggle('active', index === activeIndex);
                });
            }
            
            // 自动旋转
            function startAutoRotation() {
                if (autoRotate) {
                    rotationInterval = setInterval(() => {
                        rotate(-rotationSpeed);
                    }, 30);
                }
            }
            
            // 停止自动旋转
            function stopAutoRotation() {
                clearInterval(rotationInterval);
            }
            
            // 加速旋转
            function speedUp() {
                if (rotationSpeed < 0.03) {
                    rotationSpeed += 0.002;
                }
            }
            
            // 减速旋转
            function slowDown() {
                if (rotationSpeed > 0.005) {
                    rotationSpeed -= 0.002;
                }
            }
            
            // 切换旋转状态
            function toggleRotation() {
                autoRotate = !autoRotate;
                if (autoRotate) {
                    startAutoRotation();
                    toggleBtn.textContent = '暂停';
                } else {
                    stopAutoRotation();
                    toggleBtn.textContent = '继续';
                }
            }
            
            // 事件监听
            prevBtn.addEventListener('click', () => {
                stopAutoRotation();
                rotate((2 * Math.PI) / itemCount);
                setTimeout(() => {
                    if (autoRotate) startAutoRotation();
                }, 3000);
            });
            
            nextBtn.addEventListener('click', () => {
                stopAutoRotation();
                rotate(-(2 * Math.PI) / itemCount);
                setTimeout(() => {
                    if (autoRotate) startAutoRotation();
                }, 3000);
            });
            
            speedUpBtn.addEventListener('click', speedUp);
            slowDownBtn.addEventListener('click', slowDown);
            toggleBtn.addEventListener('click', toggleRotation);
            
            // 鼠标拖动控制
            let isDragging = false;
            let startX = 0;
            let startAngle = 0;
            
            track.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.clientX;
                startAngle = currentAngle;
                stopAutoRotation();
                toggleBtn.textContent = '继续';
            });
            
            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                const deltaX = e.clientX - startX;
                // 根据鼠标移动距离计算旋转角度
                currentAngle = startAngle + deltaX * 0.008; // 降低拖动灵敏度
                layoutItems();
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
                setTimeout(() => {
                    if (autoRotate) startAutoRotation();
                }, 2000);
            });
            
            // 触摸设备支持
            track.addEventListener('touchstart', (e) => {
                isDragging = true;
                startX = e.touches[0].clientX;
                startAngle = currentAngle;
                stopAutoRotation();
                toggleBtn.textContent = '继续';
            });
            
            document.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                
                const deltaX = e.touches[0].clientX - startX;
                currentAngle = startAngle + deltaX * 0.008;
                layoutItems();
            });
            
            document.addEventListener('touchend', () => {
                isDragging = false;
                setTimeout(() => {
                    if (autoRotate) startAutoRotation();
                }, 2000);
            });
            
            // 悬停暂停自动旋转
            track.addEventListener('mouseenter', () => {
                if (autoRotate) {
                    stopAutoRotation();
                }
            });
            
            track.addEventListener('mouseleave', () => {
                if (autoRotate) {
                    startAutoRotation();
                }
            });
            
            // 初始化
            layoutItems();
            startAutoRotation();
            
            // 窗口大小变化时重新布局
            window.addEventListener('resize', layoutItems);
            
            // 预加载图片
            preloadImages();
        }
        
        function preloadImages() {
            const images = [
                '../image/三体.jpg',
                '../image/月亮与六便士.jpg',
                '../image/老人与海.jpg',
                '../image/龙族.jpg',
                '../image/狼图腾.jpg',
                '../image/围城.jpg'
            ];
            
            images.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        }
        
    </script>
</body>
</html>